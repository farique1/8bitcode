; ------------------DATA

; system BIOS calls
dcompr:	equ 0x0020	; compare HL with DE
rdvrm:	equ 0x004a	; read from VRAM
wrtvrm:	equ 0x004d	; write to VRAM
filvrm:	equ 0x0056	; fill VRAM with value
ldirmv:	equ 0x0059	; block VRAM to RAM
ldirvm:	equ 0x005c	; block RAM to VRAM
chgmod:	equ 0x005f	; change screen modes
chgclr:	equ 0x0062	; change screen color
init32:	equ 0x006f	; initialize screen 1
calpat:	equ 0x0084	; Sprite pattern table address
calatr:	equ 0x0087	; Sprite attribute table address
chsns:	equ 0x009c	; check keyboard buffer
chget:	equ 0x009f	; get key press
inlin: 	equ 0x00b1	; enter character sequence
breakx:	equ 0x00b7	; test for CRTL+STOP
cls:		equ 0x00c3	; clear the screen
beep:		equ 0x00c0	; generates a beep
posit:	equ 0x00c6	; position the cursor
erafnk:	equ 0x00cc	; toggle function keys display
gttrig: 	equ 0x00d8	; get trigger
snsmat:	equ 0x0141	; read keyboard matrix (not used)
kilbuf:	equ 0x0156	; clear keyboard buffer

; system variables
FORCLR:	equ 0xf3e9	; foreground color
BAKCLR:	equ 0xf3ea	; background color
BDRCLR:	equ 0xf3eb	; border color
LINL32:	equ 0xf3af	; screen 1 columns
TRGFLG:	equ 0xf3e8	; trigger flags
NEWKEY:	equ 0xfbe5	; read keyboard matrix
CSRSW:	equ 0xfca9	; text cursor show

; user constants
; small VRAM buffers 0x400 length
VRBUF1:	equ 0x0800	; unused
VRBUF2:	equ 0x0c00	; undo
VRBUF3:	equ 0x1000	; swap buffer
VRBUF4:	equ 0x1400	; temporary storage for names
; big VRAM buffers 0x800 length
VRBUF5:	equ 0x2800	; temporary storage for patterns
VRBUF6:	equ 0x3000	; temporary storage for colors

; user data
curat:	defb 96,128,209,0,0,0			; cursor: y,x,y1,x1,last y,last x
		defb 0x41,0x00,0x20,0x01		; cursor: char,char backup,erase char,color
edtch:	defb 0x00,0x00				; sel edit char,grid char
edthelpch:	defs 0x08,0x00				; edit helper character
edtcopych:	defs 0x08,0x00				; edit copy character
edtcopycl:	defs 0x08,0x00				; edit copy color
edtundoch:	defs 0x08,0x00				; edit undo character
edtundocl:	defs 0x08,0x00				; edit undo ccolor
scrat:	defb 0xf,0xe,0xe,0xfe,0xfe,0		; def colors: fore,back,bord,font(FG&BG),not used(FG&BG),bord bkp
rectt:	defb 0x00					; rectangle: type 0=hollow,1=filled,2=line,3=line add,4=copy
		defb 0x00,0x00,0x00,0x00		; rectangle: VRAM start(2b),height,width

		; sprites:
spfrstal:	; y,x,number,color,pat VRAM pos(2b),atr VRAM pos(2b),quantity,pattern(8b)
spcursor:	defb 96,128,0x00,1,0x00,0x00,0x00,0x00,1		; cursor sprite
		defb 0x81,0x00,0x00,0x00,0x00,0x00,0x00,0x81
spboxfil:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,2		; filled box
		defb 0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00
spboxhol:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,3		; hollow box
		defb 0xaa,0x00,0x82,0x00,0x82,0x00,0xaa,0x00
spboxlin:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,4		; line box
		defb 0xfe,0x82,0x82,0x82,0x82,0x82,0xfe,0x00
spboxadd:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,5		; add line box
		defb 0xfe,0x92,0x92,0xfe,0x92,0x92,0xfe,0x00
spboxchr:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,6		; add line box
		defb 0xfe,0x00,0xfe,0x00,0xfe,0x00,0xfe,0x00
spimcopy:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,7		; copy box
		defb 0xf8,0xf8,0xfe,0xfa,0xfa,0x22,0x3e,0x00
spimpast:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,8		; paste box
		defb 0xf8,0x88,0xbe,0xbe,0xfe,0x3e,0x3e,0x00
speditch:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,9		; edit char grid
		defb 0xff,0x81,0x81,0x81,0x81,0x81,0x81,0xff
splastcu:
sptextent:	defb 209,0,0x00,1,0x00,0x00,0x00,0x00,10		; copy box
		defb 0x00,0x00,0x00,0x00,0x00,0x00,0x81,0xff
spcharac:	defb 209,0,0x00,15,0x00,0x00,0x00,0x00,11		; character
		defb 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
splastal:
spbckgrd:	defb 209,0,0x00,15,0x00,0x00,0x00,0x00,12		; background
		defb 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff

		; edit screen work characters
		; patterns
editonch:	defb 0x00,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x00	; grid on
editofch:	defb 0xaa,0x01,0x80,0x01,0x80,0x01,0x80,0x55	; grid off
editbgch:	defb 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00	; background
		; colors
editoncl:	defb 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00	; grid on
editofcl:	defb 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00	; grid off
editbgcl:	defb 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00	; background
		; backup of chars being used for work.
editbkch:	defs 0x18,0x00						; patterns
editbkcl:	defs 0x18,0x00						; colors

		; working characters: on,off,background,xor,address of the other set	
editwrk1:	defb 0xfd,0xfe,0xff,0x03				; set 1
		defw editwrk2
editwrk2:	defb 0x00,0x01,0x02,0x01				; set 2
		defw editwrk1
editwork:	defb 0xfd,0xfe,0xff,0x03				; set using
		defw editwrk2

		; text special chars: 0xff=new line,0x01-0x1f=space amount,0x00=end
		; general texts
textclear:	defb "clear screen",0
textreset:	defb "reset screen",0
textquit:	defb "quit program",0
textsure:	defb "ARE YOU SURE ?",0

		; help text page index LUT
hlptxt:	defw texthelp1,texthelp2,texthelp3
		defw texthelp4,texthelp5,texthelp6
		defw texthelp7,texthelp8,texthelp9

		; help screen texts
texthelp1:	defb "h:HELP",0xff,0xff
		defb "   arw:NAVIGATE",0xff,0xff
		defb "   any key:EXIT",0xff,0xff
		defb "arw mouse:MOVE",0xff,0xff
		defb " +sht:MOVE * 4",0xff,0xff
		defb "spc btn1:DRAW",0xff,0xff
		defb "bs btn2:ERASE",0xff,0xff
		defb "m:TOGGLE MOUSE",0xff,0xff
		defb "f:SWAP SCREEN BUFFERS",0xff,0xff
		defb "7 8:CYCLE CURSOR COLOR",0xff,0xff
		defb "9 0:CYCLE BORDER COLOR",0
				
texthelp2:	defb "z x:CYCLE CHARACTERS",0xff,0xff
		defb " +sht:CYCLE CHARACTERS * 16",0xff,0xff
		defb "n:PICK CHARACTER UNDER CURSOR",0xff,0xff
		defb "b:CYCLE BOX MODES",0xff,0xff
		defb " FILLED WITH CURRENT CHARACTER",0xff,0xff
		defb " HOLLOW WITH CURRENT CHARACTER",0xff,0xff
		defb " HOLLOW LINES",0xff,0xff
		defb " HOLLOW ADDING LINE",0xff,0xff
		defb " FILLED INCR CHARS FROM CURRENT",0xff,0xff
		defb "   ent btn1 spc:DRAW",0xff,0xff
		defb "   esc bs c btn2:CANCEL",0

texthelp3:	defb "c:COPY AREA / PASTE",0xff,0xff
		defb "v:PASTE PREVIOUS COPY",0xff,0xff
		defb "   ent btn1 spc:PASTE",0xff,0xff
		defb "   bs btn2:ERASE AREA",0xff,0xff
		defb "   c v:CANCEL",0xff,0xff
		defb "/:SHOW CHARACTER MAP PICKER",0xff,0xff
		defb "   ent btn1 spc:PICK AND LEAVE",0xff,0xff
		defb "   bs btn2:PICK ERASE CHAR",0xff,0xff
		defb "   esc /:LEAVE",0xff,0xff
		defb "?:CHANGE CURRENT CHAR BY TYPING",0xff,0xff
		defb "   esc:LEAVE WITHOUT CHANGING",0

texthelp4:	defb "t:ENTER TEXT BY TYPING",0xff,0xff
		defb "   ent ctl+stp:LEAVE",0xff,0xff
		defb "w a s d:SCROLL UP LEFT DOWN RGHT",0xff,0xff
		defb "q e:FLIP VERTICAL HORIZONTAL",0xff,0xff
		defb " +sht:ALSO FLIP PATTERNS",0xff,0xff
		defb "u:UNDO / REDO (SOME FUNCTIONS)",0xff,0xff
		defb "y:QUICK SAVE (LOSE UNDO)",0xff,0xff
		defb "esc:CLEAR SCREEN",0xff,0xff
		defb " +sft:CLEAR SCREEN W CURR CHAR",0xff,0xff
		defb " +ctl:RESET SCREEN",0xff,0xff
		defb "q+ctl:QUIT",0

texthelp5:	defb ".:ENTER EDIT CHARACTER MODE",0xff,0xff
		defb "   arw mouse:MOVE",0xff,0xff
		defb "    +sht:MOVE * 4",0xff,0xff
		defb "   spc ent btn1:DRAW/CHOOSE CHAR",0xff,0xff
		defb "   z x:CYCLE CHARACTERS",0xff,0xff
		defb "    +shtT:CYCLE CHARACTERS * 16",0xff,0xff
		defb "   1 2:CYCLE FOREGROUND COLOR",0xff,0xff
		defb "   3 4:CYCLE BACKGROUND COLOR",0xff,0xff
		defb "   w a s d:SCROLL CHAR U D L R",0xff,0xff
		defb "   q e:FLIP CHAR HORZ VERT",0xff,0xff
		defb "   r f:ROTATE CHAR LEFT RIGHT",0

texthelp6:	defb "EDIT CHARACTER MODE - CONT",0xff,0xff
		defb "   h:INVERT CHAR",0xff,0xff
		defb "   j:CREATE CHECKERBOARD",0xff,0xff
		defb "   k:CLEAR CHARACTER",0xff,0xff
		defb "   l:FILL CHARACTER",0xff,0xff
		defb "   c:COPY CHARACTER",0xff,0xff
		defb "   v:PASTE CHARACTER",0xff,0xff
		defb "    +SHT:PASTE CHARACTER PATTERN",0xff,0xff
		defb "    +SHT:PASTE CHARACTER COLOR",0xff,0xff
		defb "   u:UNDO CHAR",0xff,0xff
		defb "   y:QUICK SAVE CHAR (LOSE UNDO)",0

texthelp7:	defb "EDIT CHARACTER MODE - CONT",0xff,0xff
		defb "   tab:SWAP WORKING CHARS",0xff,0xff
		defb "   bs:SAVE WORKING CHARS",0xff,0xff
		defb "   esc:EXIT WITHOUT SAVING",0xff,0xff
		defb "   .:EXIT",0

texthelp8:	defb "o i:SAVE LOAD FILE",0xff,0xff
		defb "   ^   ^ = MORE FILES",0xff,0xff
		defb "   arw:CHOOSE A FILE",0xff,0xff
		defb "   ent(2X):SAVE OR LOAD FILE",0xff,0xff
		defb "   spc:WRITE A NAME",0xff,0xff
		defb "   e:CHANGE EXTENSION TO LIST",0xff,0xff
		defb "   d:DELETE FILE (ent CONFIRM)",0xff,0xff
		defb "   esc:CANCEL",0

texthelp9:	defb "GENERAL CONSIDERATIONS",0xff,0xff
		defb "*A LOT OF THE tools functions",0xff,0xff
		defb " ON THE edit character SCREEN",0xff,0xff
		defb " DEPEND ON WHERE THE CURSOR IS,",0xff,0xff
		defb " THE character map OR grid area.",0xff,0xff
		defb "*working characters ARE THE GRID",0xff,0xff
		defb " AND BACKGROUND CHARACTERS ON",0xff,0xff
		defb " THE edit character SCREEN.",0xff,0xff
		defb " THEY CAN BE EDITED AND SAVED",0xff,0xff
		defb " FOR THE CURRENT SESSION.",0

		; custom font data
		; from ! to @ first pass gets FONTINT1 and FONTINT2
fontint1:	defb 0x10,0x10,0x10,0x10,0x10,0x00,0x10,0x00,0x28,0x28,0x00,0x00,0x00,0x00,0x00,0x00
		defb 0x00,0x28,0x38,0x28,0x38,0x28,0x00,0x00,0x20,0x70,0x40,0x70,0x10,0x70,0x20,0x00
		defb 0x24,0x04,0x08,0x10,0x20,0x24,0x00,0x00,0x10,0x28,0x10,0x28,0x2c,0x28,0x14,0x00
		defb 0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x20,0x20,0x20,0x10,0x08,0x00
		defb 0x20,0x10,0x08,0x08,0x08,0x10,0x20,0x00,0x00,0x10,0x38,0x10,0x38,0x10,0x00,0x00
		defb 0x00,0x00,0x10,0x38,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00
		defb 0x00,0x00,0x00,0x38,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00
		defb 0x08,0x08,0x10,0x10,0x10,0x20,0x20,0x00,0x3c,0x24,0x24,0x24,0x24,0x24,0x3c,0x00
		defb 0x08,0x18,0x08,0x08,0x08,0x08,0x1c,0x00,0x18,0x24,0x04,0x08,0x10,0x20,0x3c,0x00
		defb 0x18,0x24,0x04,0x08,0x04,0x24,0x18,0x00,0x24,0x24,0x24,0x24,0x1c,0x04,0x04,0x00
		defb 0x3c,0x20,0x38,0x04,0x04,0x04,0x38,0x00,0x18,0x10,0x20,0x38,0x24,0x24,0x18,0x00
		defb 0x3c,0x04,0x04,0x08,0x08,0x10,0x10,0x00,0x18,0x24,0x24,0x18,0x24,0x24,0x18,0x00
		defb 0x18,0x24,0x24,0x1c,0x04,0x08,0x10,0x00,0x00,0x00,0x10,0x00,0x00,0x10,0x00,0x00
		defb 0x00,0x00,0x10,0x00,0x00,0x10,0x10,0x00,0x00,0x08,0x10,0x20,0x10,0x08,0x00,0x00
		defb 0x00,0x00,0x38,0x00,0x38,0x00,0x00,0x00,0x00,0x20,0x10,0x08,0x10,0x20,0x00,0x00
		defb 0x18,0x24,0x04,0x08,0x10,0x00,0x10,0x00,0x18,0x24,0x04,0x14,0x2c,0x24,0x18,0x00
		; Text from A to ACUTE ACCENT: &h0041 - &h0060 (used to fill the lowercases with A-Z)
fontint2:	defb 0x18,0x24,0x24,0x24,0x3c,0x24,0x24,0x00,0x38,0x24,0x24,0x38,0x24,0x24,0x38,0x00
		defb 0x18,0x24,0x20,0x20,0x20,0x24,0x18,0x00,0x38,0x24,0x24,0x24,0x24,0x24,0x38,0x00
		defb 0x3c,0x20,0x20,0x38,0x20,0x20,0x3c,0x00,0x3c,0x20,0x20,0x38,0x20,0x20,0x20,0x00
		defb 0x18,0x24,0x20,0x2c,0x24,0x24,0x18,0x00,0x24,0x24,0x24,0x3c,0x24,0x24,0x24,0x00
		defb 0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x00,0x04,0x04,0x04,0x04,0x24,0x24,0x18,0x00
		defb 0x24,0x24,0x28,0x30,0x28,0x24,0x24,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x3c,0x00
		defb 0x24,0x3c,0x3c,0x24,0x24,0x24,0x24,0x00,0x24,0x34,0x34,0x2c,0x2c,0x24,0x24,0x00
		defb 0x18,0x24,0x24,0x24,0x24,0x24,0x18,0x00,0x38,0x24,0x24,0x38,0x20,0x20,0x20,0x00
		defb 0x18,0x24,0x24,0x24,0x24,0x2c,0x1c,0x00,0x38,0x24,0x24,0x38,0x24,0x24,0x24,0x00
		defb 0x18,0x24,0x20,0x18,0x04,0x24,0x18,0x00,0x38,0x10,0x10,0x10,0x10,0x10,0x10,0x00
		defb 0x24,0x24,0x24,0x24,0x24,0x24,0x18,0x00,0x24,0x24,0x24,0x24,0x24,0x18,0x18,0x00
		defb 0x24,0x24,0x24,0x24,0x3c,0x3c,0x24,0x00,0x24,0x24,0x24,0x18,0x24,0x24,0x24,0x00
		defb 0x28,0x28,0x28,0x10,0x10,0x10,0x10,0x00,0x3c,0x04,0x08,0x10,0x10,0x20,0x3c,0x00
		defb 0x38,0x20,0x20,0x20,0x20,0x20,0x38,0x00,0x20,0x20,0x10,0x10,0x10,0x08,0x08,0x00
		defb 0x38,0x08,0x08,0x08,0x08,0x08,0x38,0x00,0x10,0x28,0x00,0x00,0x00,0x00,0x00,0x00
		defb 0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x00,0x10,0x08,0x00,0x00,0x00,0x00,0x00,0x00
		; text from OPEN CURLY BRACKET to TILDE: &h007b - &h007e
fontint3:	defb 0x08,0x10,0x10,0x20,0x10,0x10,0x08,0x00,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x00
		defb 0x20,0x10,0x10,0x08,0x10,0x10,0x20,0x00,0x00,0x14,0x28,0x00,0x00,0x00,0x00,0x00
		defs 0x08,0 ; filler for DELTA character to redefine logo using the FONTINT3 routine
		; small MASCIISDRAWX logo
Logosmall:	defb 0x02,0x02,0x07,0x07,0x0f,0x0d,0x0c,0x0c,0x21,0x22,0x73,0x72,0xfa,0xd8,0x9f,0x9f
		defb 0x19,0xa2,0x92,0x8a,0xb1,0x00,0xff,0xff,0xa9,0x2b,0x2b,0x2b,0xa9,0x00,0xff,0xff
		defb 0xff,0xff,0x00,0xf3,0xfa,0x1a,0xfa,0xf3,0xff,0xff,0x00,0x31,0xaa,0xb3,0xaa,0x2a
		defb 0xfe,0xff,0x01,0x28,0xa8,0xa9,0xbb,0xaa,0x10,0x30,0xe0,0xc0,0xc0,0xe0,0x30,0x10 		; text from EXCLAMATION to AT: &h0021 - &h0040

		; line add LUT
		;	 11   12   13   14   15   16   17   18   19   1a   1b
		;	 ┴    ┬    ┤    ├    ┼    │    ─    ┌    ┐    └    ┘
lineaddlut:	defb 0x15,0x15,0x13,0x14,0x15,0x16,0x15,0x14,0x13,0x14,0x13 ; │ 16
		defb 0x11,0x12,0x15,0x15,0x15,0x15,0x17,0x12,0x12,0x11,0x11 ; ─ 17
		defb 0x15,0x12,0x15,0x14,0x15,0x14,0x12,0x18,0x12,0x14,0x15 ; ┌ 18
		defb 0x15,0x12,0x13,0x15,0x15,0x13,0x12,0x12,0x19,0x15,0x13 ; ┐ 19
		defb 0x11,0x15,0x15,0x14,0x15,0x14,0x11,0x14,0x15,0x1a,0x11 ; └ 1a
		defb 0x11,0x15,0x13,0x15,0x15,0x13,0x11,0x15,0x13,0x11,0x1b ; ┘ 1b

		; buffer area for storing VRAM information
buffcont1:	defb 0x00,0x00	; y,x of buffer 1 content (0,0 if unusable)
buffer1:	defs 0x300,0x00	; for copy/paste
buffer2:	defs 0x300,0x00	; for temporary stuff (scroll, paste box)
