10 ' YAYASG - Yet Another Yet Anoter Snake Game
20 ' Copyright (C) 2020 - Fred Rique (farique)
30 ' https://github.com/farique1/Retrorepo
40 ' Made with MSX Basic Dignified
50 ' Convert(ed) to classic MSX Basic with
60 ' https://github.com/farique1/msx-basic-dignified
70 ONERRORGOTO660
80 SCREEN1,,0:WIDTH32:KEYOFF:COLOR15,1,1:GOSUB330:GOSUB380:GOSUB240:GOSUB350:LOCATE0,0:PRINT"SIZE:1   TIME:0   @ S:1   T:0  "
90 TIME=0
100 A$=INKEY$
110 IFA$=R$THEND=1
120 IFA$=L$THEND=-1
130 IFA$=U$THEND=-&H20
140 IFA$=D$THEND=&H20
150 VPOKEP+&H1800,&H18:P=P+D:C(P-D)=P:A=VPEEK(P+&H1800):VPOKEP+&H1800,&H2:IFA>191ANDA<&HD0THENVPOKEE+&H1800,A:E=C(E):FORF=1TOI:NEXT:GOTO100
160 IFA<208ORA>&HDFTHEN200
170 L=G(RND(1)*&H276):IFVPEEK(L)<192ORVPEEK(L)>&HCFTHEN170
180 S=S+1:I=(100/(S+3))+V:VPOKEL,&HD0+RND(1)*16
190 GOTO100
200 T=TIME/60:VPOKEP+&H1800,A:VPOKE&H2003,&HD3:SS=LEN(STR$(S))-1:LOCATE5,0:PRINT"    ":LOCATE5,0:PRINTRIGHT$(STR$(S),SS):ST=LEN(STR$(T))-1:LOCATE14,0:PRINT"    ":LOCATE14,0:PRINTRIGHT$(STR$(T),ST)
210 IFINKEY$<>E$THEN210
220 IFS>MSTHENMS=S:MT=T:LOCATE22,0:PRINT"    ":LOCATE22,0:PRINTRIGHT$(STR$(MS),SS):LOCATE28,0:PRINT"    ":LOCATE28,0:PRINTRIGHT$(STR$(MT),ST)
230 NP=E:FORF=0TOS-1:VPOKENP+&H1800,&HC0+RND(1)*16:NP=C(NP):NEXT:VPOKE&H2003,&HB2:P=&H145:E=&H145:D=1:S=1:I=(100/(S+3))+V:GOTO90
240 VPOKE&H2008,&H91:VPOKE&H2009,&H91:VPOKE&H200A,&H91:VPOKE&H200B,&H91:FORI=20TO0STEP-1:FORF=1TO50:NEXT:LOCATEI,0:PRINT"Y A Y A S G ";:NEXT:LOCATE0,0:PRINT"YAYASG     ":FORI=30TO6STEP-1:FORF=1TO10:NEXT:LOCATEI,0:PRINT"; ";:NEXT
250 CU=11:LOCATECU,0:PRINT"<":LOCATE12,0:PRINT"START":LOCATE19,0:PRINTSP$(CS):LOCATE26,0:PRINTBA$(CB);
260 A$=INKEY$
270 IFA$=L$ANDCU>12THENLOCATECU,0:PRINT" ":CU=CU-7:LOCATECU,0:PRINT"<"
280 IFA$=R$ANDCU<25THENLOCATECU,0:PRINT" ":CU=CU+7:LOCATECU,0:PRINT"<"
290 IFA$=E$ANDCU=11THENLOCATE0,0:PRINTSTRING$(32," ");:VPOKE&H2008,&HF1:VPOKE&H2009,&HF1:VPOKE&H200A,&HF1:VPOKE&H200B,&HF1:RETURN
300 IFA$=E$ANDCU=18THENCS=CS+1:CS=CSMOD2:LOCATE19,0:PRINTSP$(CS):V=SP(CS):I=(100/(S+3))+V
310 IFA$=E$ANDCU=25THENCB=CB+1:CB=CBMOD3:LOCATE26,0:PRINTBA$(CB)
320 GOTO260
330 DEFINTA-Z:R$=CHR$(&H1C):L$=CHR$(&H1D):U$=CHR$(&H1E):D$=CHR$(&H1F):E$=CHR$(&HD):P=&H145:E=&H145:D=1:S=1:MS=0:MT=0
340 DIMC(&H300):DIMG(&H276):DIMSP$(2),SP(2),BA$(3),BA(3):SP$(0)="FAST":SP$(1)="SLOW":SP(0)=0:SP(1)=50:BA$(0)="HUNGRY":BA$(1)="PLENTY":BA$(2)="FIESTA":BA(0)=1:BA(1)=4:BA(2)=10:CS=0:CB=1:V=SP(CS):I=(100/(S+3))+V:RETURN
350 LOCATE6,0:PRINT" TEASING THE WORMS ":C=0:FORY=0TO&H280STEP&H20:FORX=&H1841TO&H185E:G(C)=X+Y:C=C+1:NEXT:NEXT:FORF=1TOBA(CB)
360 L=G(RND(1)*&H276):IFVPEEK(L)<192ORVPEEK(L)>&HCFTHEN360
370 VPOKEL,&HD0+RND(1)*16:NEXT:RETURN
380 BLOAD"yayasg.scr",S:LOCATE6,0:PRINT"                   "
390 IFER=0THENRETURN
400 LOCATE4,9:PRINT"GRAPHICS FILE NOT FOUND":LOCATE3,11:PRINT"PRESS ENTER TO CREATE ONE"
410 IFINKEY$<>E$THEN410
420 CLS:GOSUB480:GOSUB440:LOCATE6,0:PRINT"SAVING THE CREATION":BSAVE"yayasg.scr",&H0,&H20FF,S:LOCATE6,0:PRINT"                   "
430 RETURN
440 LOCATE0,0:PRINTSTRING$(32," ")
450 LOCATE7,11:PRINT"BUILDING THE WALLS"
460 FORF=0TO31:VPOKE&H1820+F,RND(1)*8+16:VPOKE&H1AE0+F,RND(1)*8+8:IFF>1ANDF<23THENVPOKE&H1800+F*32,RND(1)*16+8:VPOKE&H181F+F*32,RND(1)*16+8
470 NEXT:LOCATE7,13:PRINT"PLANTING THE GRASS":FORI=2TO22:FORF=1TO30:LOCATEF,I:PRINTCHR$(&HC0+RND(1)*16);:NEXT:NEXT:RETURN
480 FORF=&H2000TO&H201F
490 VPOKEF,&H11
500 NEXT
510 FORF=0TO&HFF:VPOKE&H1800+F,F:NEXT:LOCATE0,8
520 LOCATE7,9:PRINT"CREATING THE WORLD"
530 DIMB1(10):B1(0)=254:B1(1)=252:B1(2)=126:B1(3)=124:B1(4)=254:B1(5)=254:B1(6)=254:B1(7)=254:B1(8)=254:B1(9)=254:DIMB2(10):B2(0)=239:B2(1)=207:B2(2)=231:B2(3)=199:B2(4)=239:B2(5)=239:B2(6)=239:B2(7)=239:B2(8)=239:B2(9)=239
540 VPOKE&H2001,&H6E:VPOKE&H2002,&H8E:VPOKE&H2018,&H2C:VPOKE&H2019,&H3C:VPOKE&H2000,&HAC:VPOKE&H2003,&HB2:VPOKE&H201A,&H4C:VPOKE&H201B,&H5C:VPOKE&H2006,&H71:VPOKE&H2007,&H71
550 VPOKE&H2008,&HF1:VPOKE&H2009,&HF1:VPOKE&H200A,&HF1:VPOKE&H200B,&HF1:FORF=0TO&H38STEP8
560 VPOKE&H680+F,&H18:VPOKE&H681+F,&H24:VPOKE&H682+F,30*(2^INT(RND(1)*2)):VPOKE&H683+F,30*(2^INT(RND(1)*2)):VPOKE&H684+F,30*(2^INT(RND(1)*2)):VPOKE&H685+F,30*(2^INT(RND(1)*2)):VPOKE&H686+F,30*(2^INT(RND(1)*2)):VPOKE&H687+F,&H7E
570 VPOKE&H6C0+F,&H18:VPOKE&H6C1+F,&H24:VPOKE&H6C2+F,30*(2^INT(RND(1)*2+1)):VPOKE&H6C3+F,30*(2^INT(RND(1)*2+1)):VPOKE&H6C4+F,30*(2^INT(RND(1)*2+1)):VPOKE&H6C5+F,30*(2^INT(RND(1)*2+1)):VPOKE&H6C6+F,30*(2^INT(RND(1)*2+1)):VPOKE&H6C7+F,&H7E
580 VPOKE&H40+F,B1(RND(1)*10):VPOKE&H41+F,B1(RND(1)*10):VPOKE&H42+F,B1(RND(1)*10):VPOKE&H43+F,0:VPOKE&H44+F,B2(RND(1)*10):VPOKE&H45+F,B2(RND(1)*10):VPOKE&H46+F,B2(RND(1)*10):VPOKE&H47+F,0
590 VPOKE&H80+F,B1(RND(1)*10):VPOKE&H81+F,B1(RND(1)*10):VPOKE&H82+F,B1(RND(1)*10):VPOKE&H83+F,0:VPOKE&H84+F,B2(RND(1)*10):VPOKE&H85+F,B2(RND(1)*10):VPOKE&H86+F,B2(RND(1)*10):VPOKE&H87+F,0
600 VPOKE&H600+F,0:VPOKE&H601+F,0:VPOKE&H602+F,0:VPOKE&H603+F,0:VPOKE&H604+F,0:VPOKE&H605+F,0:VPOKE&H606+F,0:VPOKE&H607+F,0:M=RND(1)*6:N=RND(1)*7:VPOKE&H600+N+F,5*(2^M):VPOKE&H601+N+F,2^(M+1)
610 VPOKE&H640+F,0:VPOKE&H641+F,0:VPOKE&H642+F,0:VPOKE&H643+F,0:VPOKE&H644+F,0:VPOKE&H645+F,0:VPOKE&H646+F,0:VPOKE&H647+F,0:M=RND(1)*6:N=RND(1)*7:VPOKE&H640+N+F,5*(2^M):VPOKE&H641+N+F,2^(M+1)
620 NEXT
630 VPOKE&HC0,&HBD:VPOKE&HC1,&H7E:VPOKE&HC2,&HFF:VPOKE&HC3,&HFF:VPOKE&HC4,&HFF:VPOKE&HC5,&HFF:VPOKE&HC6,&H7E:VPOKE&HC7,&HBD:VPOKE&H13,&HDB:VPOKE&H15,&HC3:FORF=0TO7:VPOKE&H678+F,0:NEXT
640 FORF=&H180TO&H1E7:READA:VPOKEF,A:NEXT:FORF=&H200TO&H2D7:READA:VPOKEF,A:NEXT
650 RETURN
660 IFERR=53THENER=1:RESUME390
670 ONERRORGOTO0
680 PRINT" (";RIGHT$(STR$(ERR),LEN(STR$(ERR))-1);") at";ERL;
690 END
700 DATA120,252,204,204,204,252,120,0,112,240,240,48,48,252,252,0,120,252,204,28,56,252,252,0,120,252,204,24,204,252,120,0,60,124,236,204,252,252,12,0,252,252,248,252,28,252,248,0,124,252,240,252,204,252,120,0,252,252,204,28,56,48,48,0
710 DATA120,252,204,120,204,252,120,0,120,252,204,252,60,252,248,0,0,48,48,0,48,48,0,0,24,60,60,24,24,0,24,0,0,24,12,190,12,24,0,0
720 DATA216,219,248,251,219,219,219,0,120,252,204,252,252,204,204,0,248,252,204,248,204,252,248,0,120,252,204,192,204,252,120,0,248,252,204,204,204,252,248,0,252,252,192,240,192,252,252,0,252,252,192,248,248,192,192,0,120,252,192,220,204,252,120,0
730 DATA204,204,252,252,204,204,204,0,120,120,48,48,48,120,120,0,12,12,12,12,204,252,120,0,204,220,248,240,248,220,204,0,192,192,192,192,192,252,252,0,132,204,252,252,204,204,204,0,204,204,236,252,220,204,204,0,120,252,204,204,204,252,120,0
740 DATA248,252,204,252,248,192,192,0,120,252,204,204,220,248,124,0,248,252,204,252,248,216,204,0,120,252,224,120,28,252,120,0,252,252,48,48,48,48,48,0,204,204,204,204,204,252,120,0,204,204,204,204,120,120,48,0,204,204,204,252,252,204,132,0
750 DATA204,204,120,48,120,204,204,0,204,204,252,120,48,48,48,0,252,252,28,56,112,252,252,0
