10 'Converted with MSX Basic Dignified
20 'https://github.com/farique1/msx-basic-dignified
30 ' YAYASG - Yet Another Yet Anoter Snake Game
40 ' Screen 1.5 version (Full Color)
50 ' Copyright (C) 2020 - Fred Rique (farique)
60 ' https://github.com/farique1/Retrorepo
70 ' Made with MSX Basic Dignified
80 ' Convert(ed) to classic MSX Basic with
90 ' https://github.com/farique1/msx-basic-dignified
100 ONERRORGOTO1130
110 SCREEN1,,0:WIDTH32:KEYOFF:COLOR15,1,1:GOSUB380:GOSUB430:GOSUB290:GOSUB400:LOCATE0,0:PRINT"SIZE:1   TIME:0   @ S:1   T:0  "
120 TIME=0
130 A$=INKEY$
140 IFA$=R$THEND=1
150 IFA$=L$THEND=-1
160 IFA$=U$THEND=-&H20
170 IFA$=D$THEND=&H20
180 VPOKEP+&H1800,&H18:P=P+D:C(P-D)=P:A=VPEEK(P+&H1800):VPOKEP+&H1800,&H2:IF(A>&HBF)ANDA<&HD0THENVPOKEE+&H1800,A:E=C(E):FORF=1TOI:NEXT:GOTO130
190 IF(A<&HD0)ORA>&HD7THEN230
200 L=G(RND(1)*&H276):IFVPEEK(L)<192ORVPEEK(L)>&HCFTHEN200
210 S=S+1:I=(100/(S+3))+V:VPOKEL,&HD0+RND(1)*8
220 GOTO130
230 T=TIME/60:VPOKEP+&H1800,A:VPOKE&H20C0,&HD2:VPOKE&H20C1,&HD2:VPOKE&H20C2,&HD7:VPOKE&H20C3,&HD7:VPOKE&H20C4,&HD7:VPOKE&H20C5,&HD7:VPOKE&H20C6,&HD2:VPOKE&H20C7,&HD2
240 SS=LEN(STR$(S))-1:LOCATE5,0:PRINT"    ":LOCATE5,0:PRINTRIGHT$(STR$(S),SS):ST=LEN(STR$(T))-1:LOCATE14,0:PRINT"    ":LOCATE14,0:PRINTRIGHT$(STR$(T),ST)
250 IFINKEY$<>E$THEN250
260 IFS>MSTHENMS=S:MT=T:LOCATE22,0:PRINT"    ":LOCATE22,0:PRINTRIGHT$(STR$(MS),SS):LOCATE28,0:PRINT"    ":LOCATE28,0:PRINTRIGHT$(STR$(MT),ST)
270 NP=E:FORF=0TOS-1:VPOKENP+&H1800,&HC0+RND(1)*16:NP=C(NP):NEXT:VPOKE&H20C0,&HA2:VPOKE&H20C1,&HA2:VPOKE&H20C2,&HAB:VPOKE&H20C3,&HAB:VPOKE&H20C4,&HAB:VPOKE&H20C5,&HAB:VPOKE&H20C6,&HA2:VPOKE&H20C7,&HA2
280 P=&H145:E=&H145:D=1:S=1:I=(100/(S+3))+V:GOTO120
290 VPOKE&H2008,&H91:VPOKE&H2009,&H91:VPOKE&H200A,&H91:VPOKE&H200B,&H91:FORI=20TO0STEP-1:FORF=1TO50:NEXT:LOCATEI,0:PRINT"Y A Y A S G ";:NEXT:LOCATE0,0:PRINT"YAYASG     ":FORI=30TO6STEP-1:FORF=1TO10:NEXT:LOCATEI,0:PRINT"; ";:NEXT
300 CU=11:LOCATECU,0:PRINT"<":LOCATE12,0:PRINT"START":LOCATE19,0:PRINTSP$(CS):LOCATE26,0:PRINTBA$(CB);
310 A$=INKEY$
320 IFA$=L$ANDCU>12THENLOCATECU,0:PRINT" ":CU=CU-7:LOCATECU,0:PRINT"<"
330 IFA$=R$ANDCU<25THENLOCATECU,0:PRINT" ":CU=CU+7:LOCATECU,0:PRINT"<"
340 IFA$=E$ANDCU=11THENLOCATE0,0:PRINTSTRING$(32," ");:VPOKE&H2008,&HF1:VPOKE&H2009,&HF1:VPOKE&H200A,&HF1:VPOKE&H200B,&HF1:RETURN
350 IFA$=E$ANDCU=18THENCS=CS+1:CS=CSMOD2:LOCATE19,0:PRINTSP$(CS):V=SP(CS):I=(100/(S+3))+V
360 IFA$=E$ANDCU=25THENCB=CB+1:CB=CBMOD3:LOCATE26,0:PRINTBA$(CB)
370 GOTO310
380 DEFINTA-Z:R$=CHR$(&H1C):L$=CHR$(&H1D):U$=CHR$(&H1E):D$=CHR$(&H1F):E$=CHR$(&HD):P=&H145:E=&H145:D=1:S=1:MS=0:MT=0
390 DIMC(&H300):DIMG(&H276):DIMSP$(2),SP(2),BA$(3),BA(3):SP$(0)="FAST":SP$(1)="SLOW":SP(0)=0:SP(1)=50:BA$(0)="HUNGRY":BA$(1)="PLENTY":BA$(2)="FIESTA":BA(0)=1:BA(1)=4:BA(2)=10:CS=0:CB=1:V=SP(CS):I=(100/(S+3))+V:RETURN
400 LOCATE6,0:PRINT" TEASING THE WORMS ":C=0:FORY=0TO&H280STEP&H20:FORX=&H1841TO&H185E:G(C)=X+Y:C=C+1:NEXT:NEXT:FORF=1TOBA(CB)
410 L=G(RND(1)*&H276):IFVPEEK(L)<192ORVPEEK(L)>&HCFTHEN410
420 VPOKEL,&HD0+RND(1)*8:NEXT:RETURN
430 BLOAD"yayasgFC.scr",S:LOCATE6,0:PRINT"                   "
440 IFER=0THENVDP(0)=VDP(0)OR2:VDP(1)=VDP(1)AND&HE7:VDP(3)=&H9F:VDP(4)=0:RETURN
450 LOCATE4,9:PRINT"GRAPHICS FILE NOT FOUND":LOCATE3,11:PRINT"PRESS ENTER TO CREATE ONE"
460 IFINKEY$<>E$THEN460
470 CLS:VDP(0)=VDP(0)OR2
480 VDP(1)=VDP(1)AND&HE7
490 VDP(3)=&H9F:VDP(4)=0
500 GOSUB600:LOCATE0,0:PRINTSTRING$(32," ");
510 GOSUB530:LOCATE6,0:PRINT"SAVING THE CREATION":BSAVE"yayasgFC.scr",&H0,&H27FF,S:LOCATE6,0:PRINT"                   "
520 RETURN
530 LOCATE7,11:PRINT"BUILDING THE WALLS"
540 FORF=1TO30:VPOKE&H1820+F,RND(1)*8+8:VPOKE&H1AE0+F,RND(1)*8+8:IFF>1ANDF<23THENVPOKE&H1800+F*32,RND(1)*8+8:VPOKE&H181F+F*32,RND(1)*8+8
550 NEXT:VPOKE&H1820,&H10
560 VPOKE&H183F,&H11
570 VPOKE&H1AE0,&H12
580 VPOKE&H1AFF,&H13
590 LOCATE7,13:PRINT"PLANTING THE GRASS":FORI=2TO22:FORF=1TO30:LOCATEF,I:PRINTCHR$(&HC0+RND(1)*16);:NEXT:NEXT:RETURN
600 LOCATE7,9:PRINT"CREATING THE WORLD"
610 FORF=0TO&HFF:VPOKE&H1800+F,F:NEXT:LOCATE0,8
620 FORF=&H180TO&H1E7:READA:VPOKEF,A:VPOKE&H2000+F,&H71
630 NEXT
640 C=&HE1
650 FORF=&H200TO&H2D7
660 READA
670 VPOKEF,A
680 B=FMOD4
690 IFB=0THENC=(&HE1-C)+&HF1
700 VPOKE&H2000+F,C
710 NEXT
720 DIMB1(10):B1(0)=254:B1(1)=252:B1(2)=126:B1(3)=124:B1(4)=254:B1(5)=254:B1(6)=254:B1(7)=254:B1(8)=254:B1(9)=254:DIMB2(10):B2(0)=239:B2(1)=207:B2(2)=231:B2(3)=199:B2(4)=239:B2(5)=239:B2(6)=239:B2(7)=239:B2(8)=239:B2(9)=239
730 FORF=0TO&H38STEP8
740 VPOKE&H680+F,60:VPOKE&H681+F,126:VPOKE&H682+F,219:VPOKE&H683+F,30*(2^INT(RND(1)*3)):VPOKE&H684+F,30*(2^INT(RND(1)*3)):VPOKE&H685+F,30*(2^INT(RND(1)*3)):VPOKE&H686+F,&H7E:VPOKE&H687+F,&HFF
750 VPOKE&H2680+F,&H52
760 VPOKE&H2681+F,&H42
770 VPOKE&H2682+F,&H5F
780 VPOKE&H2683+F,&H42
790 VPOKE&H2684+F,&H52
800 VPOKE&H2685+F,&H42
810 VPOKE&H2686+F,&H43
820 VPOKE&H2687+F,&HC3
830 VPOKE&H40+F,B1(RND(1)*10):VPOKE&H41+F,B1(RND(1)*10):VPOKE&H42+F,B1(RND(1)*10):VPOKE&H43+F,0:VPOKE&H44+F,B2(RND(1)*10):VPOKE&H45+F,B2(RND(1)*10):VPOKE&H46+F,B2(RND(1)*10):VPOKE&H47+F,0
840 VPOKE&H2040+F,&H9F
850 VPOKE&H2041+F,&H8F
860 VPOKE&H2042+F,&H6F
870 VPOKE&H2043+F,&H6E
880 VPOKE&H2044+F,&H9F
890 VPOKE&H2045+F,&H8F
900 VPOKE&H2046+F,&H6F
910 VPOKE&H2047+F,&H6E
920 VPOKE&H600+F,0:VPOKE&H601+F,0:VPOKE&H602+F,0:VPOKE&H603+F,0:VPOKE&H604+F,0:VPOKE&H605+F,0:VPOKE&H606+F,0:VPOKE&H607+F,0:M=RND(1)*6:N=RND(1)*6:VPOKE&H600+N+F,5*(2^M):VPOKE&H601+N+F,2^(M+1)
930 VPOKE&H602+N+F,7*(2^M):VPOKE&H2600+F,2:VPOKE&H2601+F,2:VPOKE&H2602+F,2:VPOKE&H2603+F,2:VPOKE&H2604+F,2:VPOKE&H2605+F,2:VPOKE&H2606+F,2:VPOKE&H2607+F,2:VPOKE&H2600+N+F,&H32:VPOKE&H2601+N+F,&H32:VPOKE&H2602+N+F,&HC2
940 NEXT
950 FORF=0TO31STEP8
960 VPOKE&H80+F,B1(RND(1)*10):VPOKE&H81+F,B1(RND(1)*10):VPOKE&H82+F,B1(RND(1)*10):VPOKE&H83+F,0:VPOKE&H84+F,B2(RND(1)*10):VPOKE&H85+F,B2(RND(1)*10):VPOKE&H86+F,B2(RND(1)*10):VPOKE&H87+F,0
970 VPOKE&H2080+F,&H9F
980 VPOKE&H2081+F,&H8F
990 VPOKE&H2082+F,&H6F
1000 VPOKE&H2083+F,&H6E
1010 VPOKE&H2084+F,&H9F
1020 VPOKE&H2085+F,&H8F
1030 VPOKE&H2086+F,&H6F
1040 VPOKE&H2087+F,&H6E
1050 NEXT
1060 VPOKE&H80,&H3F:VPOKE&H2080,&H91:VPOKE&H81,&H7F:VPOKE&H2081,&H81:VPOKE&H88,&HFC:VPOKE&H2088,&H91:VPOKE&H89,&HFE:VPOKE&H2089,&H81:VPOKE&H96,&H7F:VPOKE&H2096,&H61:VPOKE&H97,&H3F:VPOKE&H2097,&HE1:VPOKE&H9E,&HFE:VPOKE&H209E,&H61
1070 VPOKE&H9F,&HFC:VPOKE&H209F,&HE1
1080 VPOKE&HC0,&HBD:VPOKE&HC1,&H7E:VPOKE&HC2,&HE7:VPOKE&HC3,&HC3:VPOKE&HC4,&HC3:VPOKE&HC5,&HE7:VPOKE&HC6,&H7E:VPOKE&HC7,&HBD
1090 VPOKE&H2010,&HA2:VPOKE&H2011,&HA2:VPOKE&H2012,&HAF:VPOKE&H2013,&HA1:VPOKE&H2014,&HA9:VPOKE&H2015,&HA6:VPOKE&H2016,&HA2:VPOKE&H2017,&HA2
1100 VPOKE&H10,60:VPOKE&H11,126:VPOKE&H12,219:VPOKE&H13,219:VPOKE&H14,129:VPOKE&H15,195:VPOKE&H16,126:VPOKE&H17,60:VPOKE&H20C0,&HA2:VPOKE&H20C1,&HA2:VPOKE&H20C2,&HAB:VPOKE&H20C3,&HAB:VPOKE&H20C4,&HAB:VPOKE&H20C5,&HAB:VPOKE&H20C6,&HA2:VPOKE&H20C7,&HA2
1110 FORF=0TO63:VPOKE&H640+F,0:VPOKE&H2640+F,&H22:NEXT
1120 RETURN
1130 IFERR=53THENER=1:RESUME440
1140 ONERRORGOTO0
1150 PRINT" (";RIGHT$(STR$(ERR),LEN(STR$(ERR))-1);") at";ERL;
1160 END
1170 DATA120,252,204,204,204,252,120,0,112,240,240,48,48,252,252,0,120,252,204,28,56,252,252,0,120,252,204,24,204,252,120,0,60,124,236,204,252,252,12,0,252,252,248,252,28,252,248,0,124,252,240,252,204,252,120,0,252,252,204,28,56,48,48,0
1180 DATA120,252,204,120,204,252,120,0,120,252,204,252,60,252,248,0,0,48,48,0,48,48,0,0,24,60,60,24,24,0,24,0,0,24,12,190,12,24,0,0
1190 DATA216,219,248,251,219,219,219,0,120,252,204,252,252,204,204,0,248,252,204,248,204,252,248,0,120,252,204,192,204,252,120,0,248,252,204,204,204,252,248,0,252,252,192,240,192,252,252,0,252,252,192,248,248,192,192,0,120,252,192,220,204,252,120,0
1200 DATA204,204,252,252,204,204,204,0,120,120,48,48,48,120,120,0,12,12,12,12,204,252,120,0,204,220,248,240,248,220,204,0,192,192,192,192,192,252,252,0,132,204,252,252,204,204,204,0,204,204,236,252,220,204,204,0,120,252,204,204,204,252,120,0
1210 DATA248,252,204,252,248,192,192,0,120,252,204,204,220,248,124,0,248,252,204,252,248,216,204,0,120,252,224,120,28,252,120,0,252,252,48,48,48,48,48,0,204,204,204,204,204,252,120,0,204,204,204,204,120,120,48,0,204,204,204,252,252,204,132,0
1220 DATA204,204,120,48,120,204,204,0,204,204,252,120,48,48,48,0,252,252,28,56,112,252,252,0
