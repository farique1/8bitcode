10 ' YAYASG! - Yet Another Yet Anoter Snake Game!
20 ' Semigraphics 24 version
30 ' Copyright (C) 2020 - Fred Rique (farique)
40 ' https://github.com/farique1/8bitcode
50 ' Converted with CoCo Basic Dignified
60 ' https://github.com/farique1/coco-basic-dignified
70 DEF FNB(C)=((255-C)*3+3-(256*(2-INT(C/85.5))))*INT((C/255)+0.99609)
80 ZZ=&HE00
90 ZY=-1
100 CLS:?@&H2C,"YAYASG!"
110 ?@&HC1,"DO YOU HAVE THE WORLD ON DISK?"
120 ?@&H101,"n  TO CREATE A BRAND NEW WORLD"
130 A$=INKEY$:IF A$=""THEN130
140 IF A$="N" OR A$="n" THEN ZY=0
150 PMODE 3,1
160 POKE &HFFD7,0
170 A=PEEK (&HFF22):POKE &HFF22,(A AND &H7):POKE &HFFC5,1:POKE &HFFC3,1:POKE &HFFC0,0
180 RE=ZZ:B=RE/&H200:A=1:FOR I=&HFFC6 TO &HFFD2 STEP 2:POKE I-((B AND A)=A),0:A=A*2:NEXT
190 POKE&HBA,ZZ/&H100:POKE&H167,&H39
200 POKE &HB3,FNB(&H60)
210 PCLS
220 GOSUB 960
230 IF ZY THEN GOSUB 1300:GOSUB 1680 ELSE GOSUB 1450:GOSUB 1680:GOSUB 1320
240 GOSUB 740:GOSUB 1240
250 T$="SIZE:1   TIME:0     S:1   T:0   "
260 L=-1:GOSUB 1870
270 L=18:GOSUB 2130
280 TIMER=0
290 A$=INKEY$
300 IF A$=R$ THEN K=8:J=0
310 IF A$=L$ THEN K=-8:J=0
320 IF A$=U$ THEN J=-&HC:K=0
330 IF A$=D$ THEN J=&HC:K=0
340 PUT(X,Y)-(X,Y+11),ST:X=X+K:Y=Y+J:A=PPOINT(X+6,Y+6):C=C+1:IF C>&H400 THEN 420
350 M(C)=X:N(C)=Y:IF A<>1 THEN 380
360 PUT(X,Y)-(X,Y+11),SH:U=M(C-S):W=N(C-S):B=RND(5):IF B=1 THEN PUT(U,W)-(U,W+11),V1 ELSE PUT(U,W)-(U,W+11),BK
370 FOR F=1 TOI:NEXT:GOTO 290
380 IF A=4 THEN 490
390 G=RND(30)*8+8:H=RND(13)*12+24:IF PPOINT(G+6,H+6)<>1 THEN390
400 S=S+1:I=INT((&H64/(S+&H3))+V):B=RND(4):IF B=1 THEN PUT(G,H)-(G,H+11),W1 ELSE IF B=2 THEN PUT(G,H)-(G,H+11),W2 ELSE IF B=3 THEN PUT(G,H)-(G,H+11),W3 ELSE IF B=4 THEN PUT(G,H)-(G,H+11),W4
410 GOTO 290
420 GET(0,0)-(255,11),YA
430 POKE&HB2,FNB(&H60):LINE(0,0)-(255,11),PSET,BF
440 T$="SORRY GOT TIRED"
450 L=&H8:I=1:GOSUB 1820
460 TIMER=0
470 A$=INKEY$:IF A$<>E$ AND TIMER<100 THEN470
480 PUT(0,0)-(255,11),YA
490 TI=INT(TIMER/60)
500 T$="    "
510 L=4:GOSUB 1870
520 SS=LEN(STR$(S))-1
530 T$=RIGHT$(STR$(S),SS)
540 L=4:GOSUB 1870
550 T$="    "
560 L=13:GOSUB 1870
570 ST=LEN(STR$(TI))-1
580 T$=RIGHT$(STR$(TI),ST)
590 L=13:GOSUB 1870
600 IF INKEY$<>E$THEN 600
610 IF S>MS THEN MS=S:MT=TI:T$="    ":L=21:GOSUB 1870:T$=RIGHT$(STR$(MS),SS):L=21:GOSUB 1870:T$="    ":L=27:GOSUB 1870:T$=RIGHT$(STR$(MT),ST):L=27:GOSUB 1870
620 FOR F=C-S TO C-1
630 U=M(F):W=N(F)
640 A=RND(5)
650 IF A=1 THEN PUT(U,W)-(U,W+11),V1 ELSE PUT(U,W)-(U,W+11),BK
660 NEXT
670 X=32:Y=96
680 K=8:J=0
690 U=24:W=96
700 M(0)=24:N(0)=96
710 M(1)=32:N(1)=96
720 C=1
730 S=&H1:I=INT((&H64/(S+&H3))+V):GOTO 280
740 FOR F=256 TO 0 STEP-8
750 PUT(F,0)-(F+47,11),YA
760 NEXT
770 FOR F=256 TO 48 STEP-8
780 PUT(F,0)-(F+15,11),YE
790 NEXT
800 CU=11:BK$=" "
810 L=11:T$="START":I=1:GOSUB 1820
820 L=18:T$=SP$(CS):I=1:GOSUB 1820
830 L=25:T$=BA$(CB):I=1:GOSUB 1820
840 L=CU:GOSUB 2080
850 A$=INKEY$
860 IF A$=L$ AND CU>12 THEN L=CU:GOSUB 2180:CU=CU-7:L=CU:GOSUB 2080
870 IF A$=R$ AND CU<25 THEN L=CU:GOSUB 2180:CU=CU+7:L=CU:GOSUB 2080
880 IF A$=E$ AND CU=11 THEN POKE&HB2,FNB(&H60):LINE(0,0)-(255,11),PSET,BF:RETURN
890 IF A$=E$ AND CU=18 THEN CS=CS+1:NU=CS:DI=2:GOSUB 940:CS=NU:L=18:T$=SP$(CS):I=1:GOSUB 1820
900 V=SP(CS):I=INT((&H64/(S+3))+V)
910 IF A$=E$ AND CU=25 THEN CB=CB+1:NU=CB:DI=3:GOSUB 940:CB=NU:L=25:T$=BA$(CB):I=1:GOSUB 1820
920 GOTO 850
930 RETURN
940 IF NU>DI-1 THEN NU=0
950 RETURN
960 R$=CHR$(9):L$=CHR$(8)
970 U$=CHR$(94):D$=CHR$(10)
980 E$=CHR$(&HD)
990 X=32:Y=96
1000 K=8:J=0
1010 U=24:W=96
1020 C=1
1030 S=&H1
1040 MS=&H0
1050 MT=&H0
1060 CS=0:CB=1
1070 I=INT((&H64/(S+3))+V)
1080 DIM AW(5),HI(5),W1(8),W2(8),W3(8),W4(8),SH(7)
1090 DIM ST(7),BK(7),M1(12),M2(12),M3(12)
1100 DIM V1(3),YA(&H100),YE(16)
1110 DIM M(&H400)
1120 DIM N(&H400)
1130 M(0)=24:N(0)=96
1140 M(1)=32:N(1)=96
1150 DIM SP$(2),SP(2),BA$(3),BA(3)
1160 SP$(0)="SLOW":SP$(1)="SLUG"
1170 SP(0)=0:SP(1)=30
1180 BA$(0)="HUNGRY":BA$(1)="PLENTY":BA$(2)="FIESTA"
1190 BA(0)=1:BA(1)=4:BA(2)=10
1200 V=SP(CS)
1210 FOR F=0 TO 4:READ A$:AW(F)=VAL("&H"+A$):NEXT
1220 FOR F=0 TO 4:READ A$:HI(F)=VAL("&H"+A$):NEXT
1230 RETURN
1240 FOR F=&H1 TO BA(CB)
1250 XX=RND(30)*8:YY=RND(13)*12+12:IF PPOINT(XX+6,YY+6)<>1 THEN 1250
1260 A=RND(4)
1270 IF A=1 THEN PUT(XX,YY)-(XX,YY+11),W1 ELSE IF A=2 THEN PUT(XX,YY)-(XX,YY+11),W2 ELSE IF A=3 THEN PUT(XX,YY)-(XX,YY+11),W3 ELSE IF A=4 THEN PUT(XX,YY)-(XX,YY+11),W4
1280 NEXT
1290 RETURN
1300 IF ZY THEN LOADM "YAYASGSG.SCR":RETURN
1310 RETURN
1320 T$="BUILDING THE WALLS":L=6+8*&H180:I=1:GOSUB 1820
1330 FOR F=0 TO 255 STEP 16:PUT(F,12)-(F,23),M1:PUT(F+8,12)-(F+8,23),M2:PUT(F,180)-(F,191),M1:PUT(F+8,180)-(F+8,191),M2:NEXT
1340 FOR F=24 TO 168 STEP 8:PUT(0,F)-(0,F+11),M3:PUT(248,F)-(248,F+11),M3:NEXT
1350 T$="PLANTING THE GRASS":L=6+10*&H180:I=1:GOSUB 1820
1360 FOR YY=24 TO 178 STEP 12
1370 LINE(9,YY)-(247,YY+11),PSET,BF
1380 FOR XX=8 TO 247 STEP 8
1390 A=RND(5)
1400 IF A=1 THEN PUT(XX,YY)-(XX,YY+11),V1 ELSE PUT(XX,YY)-(XX,YY+11),BK
1410 NEXT
1420 NEXT
1430 SAVEM "YAYASGSG.SCR",&HE00,&H2600,&HE00:SCREEN 0:END
1440 RETURN
1450 T$="CREATING THE WORLD":L=6+6*&H180:I=1:GOSUB 1820
1460 POKE&HB2,FNB(&H20):LINE(0,0)-(87,11),PSET,BF
1470 FOR F=0 TO 6:READ A$:A=VAL("&H"+A$):W1(F)=A:W2(F)=A:W3(F)=A:W4(F)=A:NEXT
1480 READ A$:W1(7)=VAL("&H"+A$):READ A$:W2(7)=VAL("&H"+A$):READ A$:W3(7)=VAL("&H"+A$):READ A$:W4(7)=VAL("&H"+A$)
1490 FOR F=0 TO 6:READ A$:SH(F)=VAL("&H"+A$):NEXT
1500 FOR F=0 TO 6:READ A$:ST(F)=VAL("&H"+A$):NEXT
1510 FOR F=0 TO 11:READ A$:M1(F)=VAL("&H"+A$):NEXT
1520 FOR F=0 TO 11:READ A$:M2(F)=VAL("&H"+A$):NEXT
1530 FOR F=0 TO 11:READ A$:M3(F)=VAL("&H"+A$):NEXT
1540 READ A:V1(0)=A:READ A$:V1(1)=VAL("&H"+A$):READ A$:V1(2)=VAL("&H"+A$)
1550 L=&HE00:FOR F=3 TO 10:POKE L+F*&H20,W1(F-3):NEXT
1560 L=&HE01:FOR F=3 TO 10:POKE L+F*&H20,W2(F-3):NEXT
1570 L=&HE02:FOR F=3 TO 10:POKE L+F*&H20,W3(F-3):NEXT
1580 L=&HE03:FOR F=3 TO 10:POKE L+F*&H20,W4(F-3):NEXT
1590 L=&HE04:FOR F=3 TO 9:POKE L+F*&H20,SH(F-3):NEXT
1600 L=&HE05:FOR F=3 TO 9:POKE L+F*&H20,ST(F-3):NEXT
1610 L=&HE07:FOR F=0 TO 11:POKE L+F*&H20,M1(F):NEXT
1620 L=&HE08:FOR F=0 TO 11:POKE L+F*&H20,M2(F):NEXT
1630 L=&HE09:FOR F=0 TO 11:POKE L+F*&H20,M3(F):NEXT
1640 L=&HE0A:F=V1(0):POKE L+(F)*&H20,V1(1):POKE L+(F+1)*&H20,V1(2)
1650 T$="YAYASG!"
1660 L=&HA:I=1:GOSUB 1820
1670 RETURN
1680 GET(0,0)-(0,11),W1
1690 GET(8,0)-(8,11),W2
1700 GET(16,0)-(16,11),W3
1710 GET(24,0)-(24,11),W4
1720 GET(32,0)-(32,11),SH
1730 GET(40,0)-(40,11),ST
1740 GET(48,0)-(48,11),BK
1750 GET(56,0)-(56,11),M1
1760 GET(64,0)-(64,11),M2
1770 GET(72,0)-(72,11),M3
1780 GET(80,0)-(80,11),V1
1790 GET(88,0)-(135,11),YA
1800 GET(136,0)-(151,11),YE
1810 RETURN
1820 FOR F=1 TO LEN(T$):T=ASC(MID$(T$,F,1)):IF I=1 THEN IF T=&H20 THEN T=&H60
1830 IF I=1 THEN IF (T>&H20 AND T<&H40) THEN T=T+&H40
1840 IF I=0 THEN IF (T>&H40 AND T<&H5B) THEN T=T-&H40
1850 POKE ZZ+L+F+&H60,T:POKE ZZ+L+F+&H80,T:POKE ZZ+L+F+&HA0,T:POKE ZZ+L+F+&HC0,T:POKE ZZ+L+F+&HE0,T:POKE ZZ+L+F+&H100,T:POKE ZZ+L+F+&H120,T:NEXT
1860 RETURN
1870 FOR F=1 TO LEN(T$)
1880 T=ASC(MID$(T$,F,1))
1890 CL=&HAF:T=T+&H40
1900 IF T>&H6F AND T<&H7A THEN CL=&HEF
1910 IF T>&H81 AND T<&HA4 THEN T=T-&H40
1920 POKE ZZ+L+F+&H00,128
1930 POKE ZZ+L+F+&H20,CL
1940 POKE ZZ+L+F+&H60,T
1950 POKE ZZ+L+F+&H80,T
1960 POKE ZZ+L+F+&HA0,T
1970 POKE ZZ+L+F+&HC0,T
1980 POKE ZZ+L+F+&HE0,T
1990 POKE ZZ+L+F+&H100,T
2000 POKE ZZ+L+F+&H120,T
2010 POKE ZZ+L+F+&H160,CL
2020 NEXT
2030 RETURN
2040 FOR F=1 TO 7
2050 POKE ZZ+L+&HE0+(F*&H20),ASC(MID$(C$,F,1))
2060 NEXT
2070 RETURN
2080 L=L+&HE80
2090 FOR F=0 TO 4
2100 POKE L+F*&H20,AW(F)
2110 NEXT
2120 RETURN
2130 L=L+&HE60
2140 FOR F=0 TO 4
2150 POKE L+F*&H20,HI(F)
2160 NEXT
2170 RETURN
2180 L=L+&HE80
2190 FOR F=0 TO 4
2200 POKE L+F*&H20,&H60
2210 NEXT
2220 RETURN
2230 DATA 7E,7E,6D,7E,7E
2240 DATA 5C,65,4B,4D,57
2250 DATA 30,30,30,32,33,34,32
2260 DATA 9F,BF,DF,FF
2270 DATA 36,38,23,34,20,36,36
2280 DATA 28,23,23,2B,23,23,28
2290 DATA CF,BF,FF,BF,CF,FF,FF,BF,CF,FF,FF,BF
2300 DATA CF,BF,CF,FF,FF,BF,CF,FF,FF,BF,CF,BF
2310 DATA FF,BF,CF,FF,FF,BF,CF,FF,FF,BF,CF,FF
2320 DATA 5,18,18
