10 ' YAYASG - Yet Another Yet Anoter Snake Game
20 ' Copyright (C) 2020 - Fred Rique (farique)
30 ' https://github.com/farique1/8bitcode
40 ' Converted with CoCo Basic Dignified
50 ' https://github.com/farique1/CoCo-basic-dignified
60 ZZ=-1
70 CLS:?@&H2C,"YAYASG!"
80 ?@&HC1,"DO YOU HAVE THE WORLD ON DISK?"
90 ?@&H101,"n  TO CREATE A BRAND NEW WORLD"
100 A$=INKEY$:IF A$=""THEN100
110 IF A$="N" OR A$="n" THEN ZZ=0
120 CLS
130 POKE &HFFD7,0:GOSUB 420:GOSUB 480:GOSUB 310:GOSUB 440:?@0,"SIZE:1   TIME:0   H S:1   T:0  "
140 TIMER=0
150 A$=INKEY$
160 IF A$=R$ THEN D=&H1
170 IF A$=L$ THEN D=-&H1
180 IF A$=U$ THEN D=-&H20
190 IF A$=D$ THEN D=&H20
200 ?@P,"*";:P=P+D:C(P-D)=P:A=PEEK(P+&H400):?@P,"O";:IF A=&H20 OR A=&H2D THEN POKE E+&H400,A:E=C(E):FOR F=1 TOI:NEXT:GOTO 150
210 IF A<>&H0 THEN 250
220 L=G(RND(&H186)):IF PEEK(L)<>&H20 AND PEEK(L)<>&H2D THEN 220
230 S=S+&H1:I=INT((&H64/(S+&H3))+V):POKE L,&H0
240 GOTO 150
250 T=INT(TIMER/60):POKE P+&H400,A:SS=LEN(STR$(S))-1:?@5,"    ";:?@5,RIGHT$(STR$(S),SS);:ST=LEN(STR$(T))-1:?@14,"    ";:?@14,RIGHT$(STR$(T),ST);
260 IF INKEY$<>E$THEN 260
270 IF S>MS THEN MS=S:MT=T:?@22,"    ";:?@22,RIGHT$(STR$(MS),SS);:?@28,"    ";:?@28,RIGHT$(STR$(MT),ST);
280 NP=E:FOR F=&H0 TO S-&H1:IF RND(&HA)=&H1 THEN A=&H2D ELSE A=&H20
290 POKE NP+&H400,A
300 NP=C(NP):NEXT:P=&H145:E=&H145:D=&H1:S=&H1:I=INT((&H64/(S+&H3))+V):GOTO 140
310 FOR I=20 TO 0 STEP-1:FOR F=1 TO10:NEXT:?@I,"Y A Y A S G ";:NEXT:?@0,"YAYASG     ":FOR I=30 TO 6 STEP-1:FOR F=1 TO10:NEXT:?@I,"! ";:NEXT
320 CU=11:?@CU,">";:?@12,"START";:?@19,SP$(CS);:?@26,BA$(CB);
330 A$=INKEY$
340 IF A$=L$ AND CU>12 THEN ?@CU," ";:CU=CU-7:?@CU,">";
350 IF A$=R$ AND CU<25 THEN ?@CU," ";:CU=CU+7:?@CU,">";
360 IF A$=E$ AND CU=11 THEN ?@0,STRING$(32," ");:RETURN
370 IF A$=E$ AND CU=18 THEN CS=CS+1:NU=CS:DI=2:GOSUB 400:CS=NU:?@19,SP$(CS);:V=SP(CS):I=INT((&H64/(S+3))+V)
380 IF A$=E$ AND CU=25 THEN CB=CB+1:NU=CB:DI=3:GOSUB 400:CB=NU:?@26,BA$(CB);
390 GOTO 330
400 IF NU>DI-1 THEN NU=0
410 RETURN
420 R$=CHR$(9):L$=CHR$(8):U$=CHR$(94):D$=CHR$(10):E$=CHR$(&HD):P=&H145:E=&H145:D=&H1:S=&H1:MS=&H0:MT=&H0
430 DIM C(&H300):DIM G(&H276):DIM SP$(2),SP(2),BA$(3),BA(3):SP$(0)="FAST":SP$(1)="SLOW":SP(0)=0:SP(1)=30:BA$(0)="HUNGRY":BA$(1)="PLENTY":BA$(2)="FIESTA":BA(0)=1:BA(1)=4:BA(2)=10:CS=0:CB=1:V=SP(CS):I=INT((&H64/(S+3))+V):RETURN
440 ?@8+0*32,"TEASING THE WORMS";:C=&H0:FOR Y=&H0 TO &H190 STEP &H20:FOR X=&H441 TO &H45E:G(C)=X+Y:C=C+1:NEXT:NEXT
450 FOR F=&H1 TO BA(CB)
460 L=G(RND(&H186)):IF PEEK(L)<>&H20 THEN 460
470 POKE L,&H0:NEXT:RETURN
480 IF ZZ THEN LOADM "YAYASG.SCR":RETURN
490 ?@7+6*32,"BUILDING THE WALLS";:FOR F=0 TO 31 STEP 2:POKE &H420+F,&HFF:POKE &H421+F,&HBF:POKE &H5E0+F,&HFF:POKE &H5E1+F,&HBF:NEXT
500 FOR F=&H440 TO &H5C0 STEP &H40:POKE F,&HBF:POKE F+&H20,&HFF:POKE F+&H1F,&HFF:POKE F+&H3F,&HBF:NEXT:?@7+8*32,"PLANTING THE GRASS";:FOR Y=&H0 TO &H190 STEP &H20:FOR X=&H441 TO &H45E:IF RND(&HA)=&H1 THEN A=&H2D ELSE A=&H20
510 POKE X+Y,A:NEXT:NEXT:RETURN
